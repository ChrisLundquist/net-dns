<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Net::DNS::Packet</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Net::DNS::Packet</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/net/dns/packet_rb.html">
                lib/net/dns/packet.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1>Name</h1>
<p>
<a href="Packet.html">Net::DNS::Packet</a> - <a href="../DNS.html">DNS</a>
packet object class
</p>
<h1>Synopsis</h1>
<pre>
  require 'net/dns/packet'
</pre>
<h1>Description</h1>
<p>
The <a href="Packet.html">Net::DNS::Packet</a> class represents an entire
<a href="../DNS.html">DNS</a> packet, divided in his main section:
</p>
<ul>
<li><a href="Header.html">Header</a> (instance of <a
href="Header.html">Net::DNS::Header</a>)

</li>
<li><a href="Question.html">Question</a> (array of <a
href="Question.html">Net::DNS::Question</a> objects)

</li>
<li>Answer, Authority, Additional (each formed by an array of <a
href="RR.html">Net::DNS::RR</a> objects)

</li>
</ul>
<p>
You can use this class whenever you need to create a <a
href="../DNS.html">DNS</a> packet, whether in an user application, in a
resolver instance (have a look, for instance, at the <a
href="Resolver.html#M000145">Net::DNS::Resolver#send</a> method) or for a
nameserver.
</p>
<p>
Some example:
</p>
<pre>
  # Create a packet
  packet = Net::DNS::Packet.new(&quot;www.example.com&quot;)
  mx = Net::DNS::Packet.new(&quot;example.com&quot;, Net::DNS::MX)

  # Getting packet binary data, suitable for network transmission
  data = packet.data
</pre>
<p>
A packet object can be created from binary <a
href="Packet.html#M000036">data</a> too, like an answer packet just
received from a network stream:
</p>
<pre>
  packet = Net::DNS::Packet::parse(data)
</pre>
<p>
Each part of a packet can be gotten by the right accessors:
</p>
<pre>
  header = packet.header     # Instance of Net::DNS::Header class
  question = packet.question # Instance of Net::DNS::Question class

  # Iterate over additional RRs
  packet.additional.each do |rr|
    puts &quot;Got an #{rr.type} record&quot;
  end
</pre>
<p>
Some iterators have been written to easy the access of those RRs, which are
often the most important. So instead of doing:
</p>
<pre>
  packet.answer.each do |rr|
    if rr.type == Net::DNS::RR::Types::A
      # do something with +rr.address+
    end
  end
</pre>
<p>
we can do:
</p>
<pre>
  packet.each_address do |ip|
    # do something with +ip+
  end
</pre>
<p>
Be sure you don&#8216;t miss all the iterators in the class documentation.
</p>
<h1>Logging facility</h1>
<p>
As <a href="Resolver.html">Net::DNS::Resolver</a> class, <a
href="Packet.html">Net::DNS::Packet</a> class has its own logging facility
too. It work in the same way the other one do, so you can maybe want to
override it or change the file descriptor.
</p>
<pre>
  packet = Net::DNS::Packet.new(&quot;www.example.com&quot;)
  packet.logger = $stderr

  # or even
  packet.logger = Logger.new(&quot;/tmp/packet.log&quot;)
</pre>
<p>
If the <a href="Packet.html">Net::DNS::Packet</a> class is directly
instantiated by the <a href="Resolver.html">Net::DNS::Resolver</a> class,
like the great majority of the time, it will use the same logger facility.
</p>
<p>
Logger level will be set to Logger::Debug if $DEBUG variable is set.
</p>
<h1>Error classes</h1>
<p>
Some error classes has been defined for the <a
href="Packet.html">Net::DNS::Packet</a> class, which are listed here to
keep a light and browsable main documentation. We have:
</p>
<ul>
<li>PacketArgumentError: Generic argument error for class <a
href="Packet.html">Net::DNS::Packet</a>

</li>
<li>PacketError: Generic <a href="Packet.html">Packet</a> error

</li>
</ul>
<h1>Copyright</h1>
<p>
Copyright (c) 2006 Marco Ceresa
</p>
<p>
All rights reserved. This program is free software; you may redistribute it
and/or modify it under the same terms as Ruby itself.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000043">additional=</a>&nbsp;&nbsp;
      <a href="#M000042">answer=</a>&nbsp;&nbsp;
      <a href="#M000044">authority=</a>&nbsp;&nbsp;
      <a href="#M000036">data</a>&nbsp;&nbsp;
      <a href="#M000037">data_comp</a>&nbsp;&nbsp;
      <a href="#M000045">each_address</a>&nbsp;&nbsp;
      <a href="#M000048">each_cname</a>&nbsp;&nbsp;
      <a href="#M000047">each_mx</a>&nbsp;&nbsp;
      <a href="#M000046">each_nameserver</a>&nbsp;&nbsp;
      <a href="#M000049">each_ptr</a>&nbsp;&nbsp;
      <a href="#M000040">header=</a>&nbsp;&nbsp;
      <a href="#M000038">inspect</a>&nbsp;&nbsp;
      <a href="#M000033">new</a>&nbsp;&nbsp;
      <a href="#M000050">nxdomain?</a>&nbsp;&nbsp;
      <a href="#M000034">parse</a>&nbsp;&nbsp;
      <a href="#M000035">query?</a>&nbsp;&nbsp;
      <a href="#M000041">question=</a>&nbsp;&nbsp;
      <a href="#M000039">truncated?</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name">Names</span>
      </div>
    </div>

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">additional</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">answer</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">answerfrom</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">answersize</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">authority</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">header</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">question</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000033" class="method-detail">
        <a name="M000033"></a>

        <div class="method-heading">
          <a href="#M000033" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(name,type=Net::DNS::A,cls=Net::DNS::IN)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a <a href="Packet.html#M000033">new</a> instance of <a
href="Packet.html">Net::DNS::Packet</a> class. Arguments are the canonical
name of the resourse, an optional type field and an optional class field.
The record type and class can be omitted; they default to <tt>A</tt> and
<tt>IN</tt>.
</p>
<pre>
  packet = Net::DNS::Packet.new(&quot;www.example.com&quot;)
  packet = Net::DNS::Packet.new(&quot;example.com&quot;, Net::DNS::MX)
  packet = Net::DNS::Packet.new(&quot;example.com&quot;,Net::DNS::TXT,Net::DNS::CH)
</pre>
<p>
This class no longer instantiate object from binary <a
href="Packet.html#M000036">data</a> coming from network streams. Please use
Net::DNS::Packet.new_from_data instead.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000033-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000033-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 126</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">name</span>,<span class="ruby-identifier">type</span>=<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">A</span>,<span class="ruby-identifier">cls</span>=<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">IN</span>)
        <span class="ruby-ivar">@header</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">Header</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:qdCount</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
        <span class="ruby-ivar">@question</span> = [<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">Question</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">name</span>,<span class="ruby-identifier">type</span>,<span class="ruby-identifier">cls</span>)]
        <span class="ruby-ivar">@answer</span> = []
        <span class="ruby-ivar">@authority</span> = []
        <span class="ruby-ivar">@additional</span> = []
        <span class="ruby-ivar">@logger</span> = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">$stdout</span>
        <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">level</span> = <span class="ruby-identifier">$DEBUG</span> <span class="ruby-operator">?</span> <span class="ruby-constant">Logger</span><span class="ruby-operator">::</span><span class="ruby-constant">DEBUG</span> <span class="ruby-operator">:</span> <span class="ruby-constant">Logger</span><span class="ruby-operator">::</span><span class="ruby-constant">WARN</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000034" class="method-detail">
        <a name="M000034"></a>

        <div class="method-heading">
          <a href="#M000034" class="method-signature">
          <span class="method-name">parse</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a <a href="Packet.html#M000033">new</a> instance of <a
href="Packet.html">Net::DNS::Packet</a> class from binary <a
href="Packet.html#M000036">data</a>, taken out by a network stream. For
example:
</p>
<pre>
  # udp_socket is an UDPSocket waiting for a response
  ans = udp_socket.recvfrom(1500)
  packet = Net::DNS::Packet::parse(ans)
</pre>
<p>
An optional <tt>from</tt> argument can be used to specify the information
of the sender. If <a href="Packet.html#M000036">data</a> is passed as is
from a Socket#recvfrom call, the method will accept it.
</p>
<p>
Be sure that your network <a href="Packet.html#M000036">data</a> is clean
from any UDP/TCP header, expecially when using RAW sockets.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000034-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000034-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 150</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Packet</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
        <span class="ruby-identifier">o</span> = <span class="ruby-identifier">allocate</span>
        <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:new_from_data</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
        <span class="ruby-identifier">o</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000043" class="method-detail">
        <a name="M000043"></a>

        <div class="method-heading">
          <a href="#M000043" class="method-signature">
          <span class="method-name">additional=</span><span class="method-args">(object)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Assign a <a href="RR.html">Net::DNS::RR</a> object, or an array of <a
href="RR.html">RR</a> objects, to a <a
href="Packet.html">Net::DNS::Packet</a> instance additional section.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000043-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000043-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 353</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">additional=</span>(<span class="ruby-identifier">object</span>)
        <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">object</span>
        <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">all?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span>}
            <span class="ruby-ivar">@additional</span> = <span class="ruby-identifier">object</span>
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Some of the elements is not an Net::DNS::RR object&quot;</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span>
          <span class="ruby-ivar">@additional</span> = [<span class="ruby-identifier">object</span>]
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Invalid argument, not a RR object nor an array of objects&quot;</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000042" class="method-detail">
        <a name="M000042"></a>

        <div class="method-heading">
          <a href="#M000042" class="method-signature">
          <span class="method-name">answer=</span><span class="method-args">(object)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Assign a <a href="RR.html">Net::DNS::RR</a> object, or an array of <a
href="RR.html">RR</a> objects, to a <a
href="Packet.html">Net::DNS::Packet</a> instance answer section.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000042-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000042-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 334</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">answer=</span>(<span class="ruby-identifier">object</span>)
        <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">object</span>
        <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">all?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span>}
            <span class="ruby-ivar">@answer</span> = <span class="ruby-identifier">object</span>
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Some of the elements is not an Net::DNS::RR object&quot;</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span>
          <span class="ruby-ivar">@answer</span> = [<span class="ruby-identifier">object</span>]
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Invalid argument, not a RR object nor an array of objects&quot;</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000044" class="method-detail">
        <a name="M000044"></a>

        <div class="method-heading">
          <a href="#M000044" class="method-signature">
          <span class="method-name">authority=</span><span class="method-args">(object)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Assign a <a href="RR.html">Net::DNS::RR</a> object, or an array of <a
href="RR.html">RR</a> objects, to a <a
href="Packet.html">Net::DNS::Packet</a> instance authority section.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000044-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000044-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 372</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authority=</span>(<span class="ruby-identifier">object</span>)
        <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">object</span>
        <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">all?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span>}
            <span class="ruby-ivar">@authority</span> = <span class="ruby-identifier">object</span>
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Some of the elements is not an Net::DNS::RR object&quot;</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span>
          <span class="ruby-ivar">@authority</span> = [<span class="ruby-identifier">object</span>]
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Invalid argument, not a RR object nor an array of objects&quot;</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000036" class="method-detail">
        <a name="M000036"></a>

        <div class="method-heading">
          <a href="#M000036" class="method-signature">
          <span class="method-name">data</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return the packet object in binary <a href="Packet.html#M000036">data</a>,
suitable for sending across a network stream.
</p>
<pre>
  packet_data = packet.data
  puts &quot;Packet is #{packet_data.size} bytes long&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000036-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000036-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 168</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">data</span>
        <span class="ruby-identifier">qdcount</span>=<span class="ruby-identifier">ancount</span>=<span class="ruby-identifier">nscount</span>=<span class="ruby-identifier">arcount</span>=<span class="ruby-value">0</span>
        <span class="ruby-identifier">data</span> = <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">data</span>
        <span class="ruby-identifier">headerlength</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span>
        
        <span class="ruby-ivar">@question</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">question</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">question</span>.<span class="ruby-identifier">data</span>
          <span class="ruby-identifier">qdcount</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">data</span><span class="ruby-comment cmt">#(data.length)</span>
          <span class="ruby-identifier">ancount</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-ivar">@authority</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">data</span><span class="ruby-comment cmt">#(data.length)</span>
          <span class="ruby-identifier">nscount</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-ivar">@additional</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">data</span><span class="ruby-comment cmt">#(data.length)</span>
          <span class="ruby-identifier">arcount</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">qdCount</span> = <span class="ruby-identifier">qdcount</span>
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">anCount</span> = <span class="ruby-identifier">ancount</span>
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">nsCount</span> = <span class="ruby-identifier">nscount</span>
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">arCount</span> = <span class="ruby-identifier">arcount</span>

        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">data</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">data</span>[<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">HFIXEDSZ</span><span class="ruby-operator">..</span><span class="ruby-identifier">data</span>.<span class="ruby-identifier">size</span>]
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000037" class="method-detail">
        <a name="M000037"></a>

        <div class="method-heading">
          <a href="#M000037" class="method-signature">
          <span class="method-name">data_comp</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same as <a href="Packet.html#M000036">Net::DNS::Packet#data</a>, but
implements name compression (see RFC1025) for a considerable save of bytes.
</p>
<pre>
  packet = Net::DNS::Packet.new(&quot;www.example.com&quot;)
  puts &quot;Size normal is #{packet.data.size} bytes&quot;
  puts &quot;Size compressed is #{packet.data_comp.size} bytes&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000037-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000037-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 205</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">data_comp</span>
        <span class="ruby-identifier">offset</span> = <span class="ruby-value">0</span>
        <span class="ruby-identifier">compnames</span> = {}
        <span class="ruby-identifier">qdcount</span>=<span class="ruby-identifier">ancount</span>=<span class="ruby-identifier">nscount</span>=<span class="ruby-identifier">arcount</span>=<span class="ruby-value">0</span>
        <span class="ruby-identifier">data</span> = <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">data</span>
        <span class="ruby-identifier">headerlength</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span>

        <span class="ruby-ivar">@question</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">question</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">str</span>,<span class="ruby-identifier">offset</span>,<span class="ruby-identifier">names</span> = <span class="ruby-identifier">question</span>.<span class="ruby-identifier">data</span>
          <span class="ruby-identifier">data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>
          <span class="ruby-identifier">compnames</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">names</span>)
          <span class="ruby-identifier">qdcount</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">str</span>,<span class="ruby-identifier">offset</span>,<span class="ruby-identifier">names</span> = <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">data</span>(<span class="ruby-identifier">offset</span>,<span class="ruby-identifier">compnames</span>)
          <span class="ruby-identifier">data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>
          <span class="ruby-identifier">compnames</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">names</span>)
          <span class="ruby-identifier">ancount</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-ivar">@authority</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">str</span>,<span class="ruby-identifier">offset</span>,<span class="ruby-identifier">names</span> = <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">data</span>(<span class="ruby-identifier">offset</span>,<span class="ruby-identifier">compnames</span>)
          <span class="ruby-identifier">data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>
          <span class="ruby-identifier">compnames</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">names</span>)
          <span class="ruby-identifier">nscount</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-ivar">@additional</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">str</span>,<span class="ruby-identifier">offset</span>,<span class="ruby-identifier">names</span> = <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">data</span>(<span class="ruby-identifier">offset</span>,<span class="ruby-identifier">compnames</span>)
          <span class="ruby-identifier">data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>
          <span class="ruby-identifier">compnames</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">names</span>)
          <span class="ruby-identifier">arcount</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">qdCount</span> = <span class="ruby-identifier">qdcount</span>
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">anCount</span> = <span class="ruby-identifier">ancount</span>
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">nsCount</span> = <span class="ruby-identifier">nscount</span>
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">arCount</span> = <span class="ruby-identifier">arcount</span>
        
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">data</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">data</span>[<span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">HFIXEDSZ</span><span class="ruby-operator">..</span><span class="ruby-identifier">data</span>.<span class="ruby-identifier">size</span>]
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000045" class="method-detail">
        <a name="M000045"></a>

        <div class="method-heading">
          <a href="#M000045" class="method-signature">
          <span class="method-name">each_address</span><span class="method-args">() {|elem.address| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iterate for every address in the <tt>answer</tt> section of a <a
href="Packet.html">Net::DNS::Packet</a> object.
</p>
<pre>
  packet.each_address do |ip|
    ping ip.to_s
  end
</pre>
<p>
As you can see in the documentation for <a
href="RR/A.html">Net::DNS::RR::A</a> class, the address returned is an
instance of IPAddr class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000045-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000045-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 397</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_address</span>
        <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">elem</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span><span class="ruby-operator">::</span><span class="ruby-constant">A</span>
          <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">address</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000048" class="method-detail">
        <a name="M000048"></a>

        <div class="method-heading">
          <a href="#M000048" class="method-signature">
          <span class="method-name">each_cname</span><span class="method-args">() {|elem.cname| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iterate for every canonical name in the <tt>answer</tt> section of a <a
href="Packet.html">Net::DNS::Packet</a> object.
</p>
<pre>
  packet.each_cname do |cname|
    puts &quot;Canonical name: #{cname}&quot;
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000048-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000048-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 439</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_cname</span>
        <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">elem</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span><span class="ruby-operator">::</span><span class="ruby-constant">CNAME</span>
          <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">cname</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000047" class="method-detail">
        <a name="M000047"></a>

        <div class="method-heading">
          <a href="#M000047" class="method-signature">
          <span class="method-name">each_mx</span><span class="method-args">() {|elem.preference,elem.exchange| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iterate for every exchange record in the <tt>answer</tt> section of a <a
href="Packet.html">Net::DNS::Packet</a> object.
</p>
<pre>
  packet.each_mx do |pref,name|
    puts &quot;Mail exchange #{name} has preference #{pref}&quot;
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000047-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000047-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 425</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_mx</span>
        <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">elem</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span><span class="ruby-operator">::</span><span class="ruby-constant">MX</span>
          <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">preference</span>,<span class="ruby-identifier">elem</span>.<span class="ruby-identifier">exchange</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000046" class="method-detail">
        <a name="M000046"></a>

        <div class="method-heading">
          <a href="#M000046" class="method-signature">
          <span class="method-name">each_nameserver</span><span class="method-args">() {|elem.nsdname| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iterate for every nameserver in the <tt>answer</tt> section of a <a
href="Packet.html">Net::DNS::Packet</a> object.
</p>
<pre>
  packet.each_nameserver do |ns|
    puts &quot;Nameserver found: #{ns}&quot;
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000046-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000046-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 411</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_nameserver</span>
        <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">elem</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span><span class="ruby-operator">::</span><span class="ruby-constant">NS</span>
          <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">nsdname</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000049" class="method-detail">
        <a name="M000049"></a>

        <div class="method-heading">
          <a href="#M000049" class="method-signature">
          <span class="method-name">each_ptr</span><span class="method-args">() {|elem.ptrdname| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iterate for every pointer in the <tt>answer</tt> section of a <a
href="Packet.html">Net::DNS::Packet</a> object.
</p>
<pre>
  packet.each_ptr do |ptr|
    puts &quot;Pointer for resource: #{ptr}&quot;
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000049-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000049-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 453</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_ptr</span>
        <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">elem</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">RR</span><span class="ruby-operator">::</span><span class="ruby-constant">PTR</span>
          <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">elem</span>.<span class="ruby-identifier">ptrdname</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000040" class="method-detail">
        <a name="M000040"></a>

        <div class="method-heading">
          <a href="#M000040" class="method-signature">
          <span class="method-name">header=</span><span class="method-args">(object)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Assing a <a href="Header.html">Net::DNS::Header</a> object to a <a
href="Packet.html">Net::DNS::Packet</a> instance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000040-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000040-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 304</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">header=</span>(<span class="ruby-identifier">object</span>)
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">Header</span>
          <span class="ruby-ivar">@header</span> = <span class="ruby-identifier">object</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Argument must be a Net::DNS::Header object&quot;</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000038" class="method-detail">
        <a name="M000038"></a>

        <div class="method-heading">
          <a href="#M000038" class="method-signature">
          <span class="method-name">inspect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inspect method
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000038-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000038-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 249</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
        <span class="ruby-identifier">retval</span> = <span class="ruby-value str">&quot;&quot;</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@answerfrom</span> <span class="ruby-operator">!=</span> <span class="ruby-value str">&quot;0.0.0.0:0&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@answerfrom</span>
          <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;;; Answer received from #@answerfrom (#{@answersize} bytes)\n;;\n&quot;</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;;; HEADER SECTION\n&quot;</span>
        <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">inspect</span>
        
        <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;\n&quot;</span>
        <span class="ruby-identifier">section</span> = (<span class="ruby-ivar">@header</span>.<span class="ruby-identifier">opCode</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;UPDATE&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;ZONE&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;QUESTION&quot;</span>
        <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;;; #{section} SECTION (#{@header.qdCount} record#{@header.qdCount == 1 ? '' : 's'}):\n&quot;</span>
        <span class="ruby-ivar">@question</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">qr</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;;; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">qr</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
        <span class="ruby-keyword kw">end</span>

        <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
          <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;\n&quot;</span>
          <span class="ruby-identifier">section</span> = (<span class="ruby-ivar">@header</span>.<span class="ruby-identifier">opCode</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;UPDATE&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;PREREQUISITE&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;ANSWER&quot;</span>
          <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;;; #{section} SECTION (#{@header.anCount} record#{@header.anCount == 1 ? '' : 's'}):\n&quot;</span>
          <span class="ruby-ivar">@answer</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>

        <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@authority</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
          <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;\n&quot;</span>
          <span class="ruby-identifier">section</span> = (<span class="ruby-ivar">@header</span>.<span class="ruby-identifier">opCode</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;UPDATE&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;UPDATE&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;AUTHORITY&quot;</span>
          <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;;; #{section} SECTION (#{@header.nsCount} record#{@header.nsCount == 1 ? '' : 's'}):\n&quot;</span>
          <span class="ruby-ivar">@authority</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@additional</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
          <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;\n&quot;</span>
          <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;;; ADDITIONAL SECTION (#{@header.arCount} record#{@header.arCount == 1 ? '' : 's'}):\n&quot;</span>
          <span class="ruby-ivar">@additional</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rr</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">retval</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">rr</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-identifier">retval</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000050" class="method-detail">
        <a name="M000050"></a>

        <div class="method-heading">
          <a href="#M000050" class="method-signature">
          <span class="method-name">nxdomain?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Chacks whether a query has returned a NXDOMAIN error, meaning the domain
name queried doesn&#8216;t exists.
</p>
<pre>
  %w[a.com google.com ibm.com d.com].each do |domain|
    response = Net::DNS::Resolver.new.send(domain)
    puts &quot;#{domain} doesn't exist&quot; if response.nxdomain?
  end
    #=&gt; a.com doesn't exist
    #=&gt; d.com doesn't exist
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000050-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000050-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 470</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nxdomain?</span>
        <span class="ruby-identifier">header</span>.<span class="ruby-identifier">rCode</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">Header</span><span class="ruby-operator">::</span><span class="ruby-constant">NAME</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000035" class="method-detail">
        <a name="M000035"></a>

        <div class="method-heading">
          <a href="#M000035" class="method-signature">
          <span class="method-name">query?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Checks if the packet is a QUERY packet
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000035-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000035-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 158</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query?</span>
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">opCode</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">Header</span><span class="ruby-operator">::</span><span class="ruby-constant">QUERY</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000041" class="method-detail">
        <a name="M000041"></a>

        <div class="method-heading">
          <a href="#M000041" class="method-signature">
          <span class="method-name">question=</span><span class="method-args">(object)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Assign a <a href="Question.html">Net::DNS::Question</a> object, or an array
of Questions objects, to a <a href="Packet.html">Net::DNS::Packet</a>
instance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000041-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000041-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 315</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">question=</span>(<span class="ruby-identifier">object</span>)
        <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">object</span>
        <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
          <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">all?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">Question</span>}
            <span class="ruby-ivar">@question</span> = <span class="ruby-identifier">object</span>
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Some of the elements is not an Net::DNS::Question object&quot;</span>
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">DNS</span><span class="ruby-operator">::</span><span class="ruby-constant">Question</span>
          <span class="ruby-ivar">@question</span> = [<span class="ruby-identifier">object</span>]
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">PacketArgumentError</span>, <span class="ruby-value str">&quot;Invalid argument, not a Question object nor an array of objects&quot;</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000039" class="method-detail">
        <a name="M000039"></a>

        <div class="method-heading">
          <a href="#M000039" class="method-signature">
          <span class="method-name">truncated?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Wrapper to Header#truncated?
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000039-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000039-source">
<pre>
<span class="ruby-comment cmt"># File lib/net/dns/packet.rb, line 297</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">truncated?</span>
        <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">truncated?</span>
      <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>